# -*- coding: utf-8 -*-
"""
Created on Wed Jun  6 22:47:12 2018

@author: Tiffany
"""

import pandas as pd



for num in range(1,14):
    df = pd.read_csv(r'C:\Users\Tiffany\Documents\dissertation\data\sorted\\'+str(num)+'_data.csv')
    #remove first index column
    del df['Unnamed: 0']
    #DF.drop('Unnamed: 0',axis=1, inplace=True)
    
    #create a new Label_1, indicate that if the netflow is infected    
    # for scenario 1
    if num==1:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                    ((df.StartTime>='2011/08/10 10:46:53.047277') & \
                     ('2011/08/10 15:49:07.368340'>=df.StartTime))
                
    # for scenario 2
    elif num==2:         
        df['Label_1']=(df.Label.str.contains('From-Botnet')) &\
                    ((df.StartTime>='2011/08/11 10:33:04') &\
                     ('2011/08/11 13:55:37'>=df.StartTime))
    
    # for scenario 3       
    elif num==3:     
        df['Label_1']=(df.Label.str.contains('From-Botnet')) &\
                        ((df.StartTime>='2011/08/12 15:00:37') &\
                        ('2011/08/15 09:55:11'>=df.StartTime))
    
    # for scenario 4
    elif num==4:
        df['Label_1']=((df.Label.str.contains('From-Botnet')) &\
                      ((df.StartTime>='2011/08/15 12:21:33') &\
                      ('2011/08/15 13:06:40'>=df.StartTime))&\
                      (df.DstAddr=='147.32.96.69')&\
                      (df.Proto=='udp'))|\
                      ((df.Label.str.contains('From-Botnet')) &\
                      (((df.StartTime>='2011/08/15 13:25:40') &\
                      ('2011/08/15 13:40:00'>=df.StartTime))|\
                      ((df.StartTime>='2011/08/15 13:50:51') &\
                      ('2011/08/15 13:58:35'>=df.StartTime)))&\
                      (df.DstAddr=='147.32.96.69')&\
                      (df.Proto=='icmp'))
    
    # for scenario 5
    elif num==5:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                    ((df.StartTime>='2011/08/15 16:52:23') & \
                     ('2011/08/15 17:13:07'>=df.StartTime))
                  
    # for scenario 6
    elif num==6:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                    ((df.StartTime>='2011/08/16 10:08:47') & \
                     ('2011/08/16 12:10:31'>=df.StartTime))  
        
    # for scenario 7
    elif num==7:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                    ((df.StartTime>='2011/08/16 13:56:07') & \
                     ('2011/08/16 14:12:17'>=df.StartTime))  
          
    # for scenario 8
    elif num==8:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                      (df.StartTime>='2011/08/16 14:24:01')        
    
    #for scenario 9
    elif num==9:
        df['Label_1']=((df.SrcAddr=='147.32.84.165') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 14:24:08') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.191') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 14:43:20') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.192') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 14:48:20') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.193') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 14:54:45') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                       ((df.SrcAddr=='147.32.84.204') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 14:56:07') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.205') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 14:57:58') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.206') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 15:00:42') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.207') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 15:01:56') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                       ((df.SrcAddr=='147.32.84.208') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 15:03:13') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))|\
                      ((df.SrcAddr=='147.32.84.209') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/17 15:04:54') & \
                      ('2011/08/17 17:10:28'>=df.StartTime)))
               
    # for scenario 10
    elif num==10:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) 
    
    # for scenario 11
    elif num==11:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                    ((df.StartTime>='2011/08/18 15:40:38') & \
                     ('2011/08/18 15:55:13'>=df.StartTime))    
    
    # for scenario 12
    elif num==12:
        df['Label_1']=(df.SrcAddr=='147.32.84.165') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/19 10:42:39') & \
                      ('2011/08/19 11:44:17'>=df.StartTime))|\
                       (df.SrcAddr=='147.32.84.191') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/19 10:47:18') & \
                      ('2011/08/19 11:44:17'>=df.StartTime))|\
                       (df.SrcAddr=='147.32.84.192') & \
                      (df.Label.str.contains('From-Botnet')) & \
                      ((df.StartTime>='2011/08/19 10:50:25') & \
                      ('2011/08/19 11:44:17'>=df.StartTime))
                 
    # for scenario 13
    elif num==13:
        df['Label_1']=(df.Label.str.contains('From-Botnet')) & \
                    ((df.StartTime>='2011/08/15 17:18:01') & \
                     ('2011/08/16 09:35:05'>=df.StartTime))
                              
    df.to_csv(r'C:\Users\Tiffany\Documents\dissertation\data\sorted\\'+str(num)+'_label_data.csv')